{"mappings":"sjBAEIA,WAqBKC,IACPC,QAAQC,IAAG,kBACXC,SAASC,cAAa,iBAAkBC,UAAUC,IAAG,YACrDH,SAASC,cAAa,kBAAmBC,UAAUE,OAAM,YACzDJ,SAASC,cAAa,UAAWC,UAAUE,OAAM,QACjDJ,SAASC,cAAa,WAAYC,UAAUC,IAAG,QAC/CH,SAASC,cAAa,iBAAkBC,UAAUC,IAAG,iBAE9CE,IACPP,QAAQC,IAAG,gBACXC,SAASC,cAAa,iBAAkBC,UAAUE,OAAM,YACxDJ,SAASC,cAAa,kBAAmBC,UAAUC,IAAG,YACtDH,SAASC,cAAa,WAAYC,UAAUE,OAAM,QAClDJ,SAASC,cAAa,UAAWC,UAAUC,IAAG,iBAEvCG,IACPR,QAAQC,IAAG,eACXC,SAASC,cAAa,UAAWC,UAAUC,IAAG,QAC9CH,SAASC,cAAa,iBAAkBC,UAAUE,OAAM,QArC1DG,OAAOC,iBAAgB,+BAErBR,SACGC,cAAa,iBACbO,iBAAgB,QAAUX,GAC7BG,SACGC,cAAa,kBACbO,iBAAgB,QAAUH,GAC7BL,SACGC,cAAa,kBACbO,iBAAgB,QAAUH,GAC7BL,SACGC,cAAa,eACbO,iBAAgB,QAAUF,GAC7BN,SACGC,cAAa,oBACbO,iBAAgB,QAAUX,UA2B3BY,EAAI,IAAOC,EAAAC,GAAP,CAAa,CACnBC,OAAM,6DACNC,WAAW,aA4GJC,EAAYC,GACnBC,EAAW,6CAA+CD,YAOnDC,EAAYC,EAAKC,GACxBA,EAAGjB,cAAa,YAAakB,UAAYF,EAnH3CjB,SACGC,cAAa,uBACbO,iBAAgB,UAAYY,OAC3BA,EAAEC,iBAEAD,EAAEE,OAAOC,SAASC,SAASC,QAAUL,EAAEE,OAAOC,SAASG,UAAUD,MAAK,CAEtE3B,QAAQC,IAAG,cAELgB,EAAOK,EAAEE,OACVb,GACHK,EAAYC,eAGNY,EAAKH,SAAEA,EAAQI,KAAEA,GAASb,EAAKQ,SACvCd,EACGoB,OAAOF,EAAMF,MAAOD,EAASC,MAAK,CACjCK,KAAI,CAAIC,UAAWH,EAAKH,SAEzBO,MAAMC,IACLnC,QAAQC,IAAI6B,EAAKH,OACjB3B,QAAQC,IAAIkC,GACZjB,EAAW,iDACwCkB,KAAKC,UACpDF,YAEFlB,MAGHqB,OAAOC,IACNrB,EAAW,mBAAoBkB,KAAKC,UAAUE,YAAiBtB,GAC/DjB,QAAQC,IAAIsC,WAGhBrB,EAAW,yBAA2BI,EAAEE,QACxCxB,QAAQC,IAAG,YAIjBC,SAASC,cAAa,sBAAuBO,iBAAgB,UAAYY,IACvEA,EAAEC,uBACIN,EAAOK,EAAEE,OACVb,GACHK,EAAYC,eAENY,EAAKH,SAAEA,GAAaT,EAAKQ,SACjCd,EACG6B,MAAMX,EAAMF,MAAOD,EAASC,OAAO,GACnCO,MAAMC,IACLjB,EAAW,6BAA+BD,GAC1CjB,QAAQC,IAAIkC,GACZrC,EAAOa,EAAK8B,cAEZC,aAAaC,QAAO,OAASP,KAAKC,UAAUvC,IAE5CW,OAAOmC,SAASC,KAAI,qBAErBP,OAAOC,IACNrB,EAAW,qBAAuBD,GAClCjB,QAAQC,IAAIsC,SAgBlBrC,SACGC,cAAa,6BACbO,iBAAgB,UAAYY,IAC3BA,EAAEC,uBACIN,EAAOK,EAAEE,OAEVb,GACHK,EAAYC,GAGTN,EAAK8B,wBAyBOxB,GACnBC,EAAW,wBAA0BD,GAzBjC6B,CAAY7B,SAIRY,EADOlB,EAAK8B,cACCZ,MAEnBlB,EACGoC,wBAAwBlB,GACxBK,MAAMC,IACLjB,EAAW,iDAAmDD,GAC9DjB,QAAQC,IAAIkC,MAEbG,OAAOC,IACNrB,EAAW,0BAA4BD,GACvCjB,QAAQC,IAAIsC","sources":["login.js"],"sourcesContent":["import GoTrue from \"gotrue-js\";\r\n\r\nlet user;\r\n//add eventlisteners\r\nwindow.addEventListener(\"DOMContentLoaded\", initListeners);\r\nfunction initListeners() {\r\n  document\r\n    .querySelector(\".login-switch\")\r\n    .addEventListener(\"click\", toggleExisting);\r\n  document\r\n    .querySelector(\".create-switch\")\r\n    .addEventListener(\"click\", toggleCreate);\r\n  document\r\n    .querySelector(\".create-switch\")\r\n    .addEventListener(\"click\", toggleCreate);\r\n  document\r\n    .querySelector(\".forgot-btn\")\r\n    .addEventListener(\"click\", toggleResetPass);\r\n  document\r\n    .querySelector(\".forgot-back-btn\")\r\n    .addEventListener(\"click\", toggleExisting);\r\n}\r\n\r\nfunction toggleExisting() {\r\n  console.log(\"toggleExisting\");\r\n  document.querySelector(\".login-switch\").classList.add(\"selected\");\r\n  document.querySelector(\".create-switch\").classList.remove(\"selected\");\r\n  document.querySelector(\".login\").classList.remove(\"hide\");\r\n  document.querySelector(\".signup\").classList.add(\"hide\");\r\n  document.querySelector(\".recover-pass\").classList.add(\"hide\");\r\n}\r\nfunction toggleCreate() {\r\n  console.log(\"toggleCreate\");\r\n  document.querySelector(\".login-switch\").classList.remove(\"selected\");\r\n  document.querySelector(\".create-switch\").classList.add(\"selected\");\r\n  document.querySelector(\".signup\").classList.remove(\"hide\");\r\n  document.querySelector(\".login\").classList.add(\"hide\");\r\n}\r\nfunction toggleResetPass() {\r\n  console.log(\"forgot pass\");\r\n  document.querySelector(\".login\").classList.add(\"hide\");\r\n  document.querySelector(\".recover-pass\").classList.remove(\"hide\");\r\n}\r\nfunction toggleBackForgot() {}\r\n\r\n//Instantiate the GoTrue auth client + GoTrue functions\r\n\r\nlet auth = new GoTrue({\r\n  APIUrl: \"https://serene-clarke-d069ee.netlify.app/.netlify/identity\",\r\n  setCookie: true,\r\n});\r\ndocument\r\n  .querySelector(\"form[name='signup']\")\r\n  .addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n    if (\r\n      e.target.elements.password.value === e.target.elements.password2.value\r\n    ) {\r\n      console.log(\"succ\");\r\n\r\n      const form = e.target;\r\n      if (!auth) {\r\n        noAuthFound(form);\r\n      }\r\n\r\n      const { email, password, name } = form.elements;\r\n      auth\r\n        .signup(email.value, password.value, {\r\n          data: { full_name: name.value },\r\n        })\r\n        .then((response) => {\r\n          console.log(name.value);\r\n          console.log(response);\r\n          showMessage(\r\n            `<p>Created a user! </p><p>Response: </p><code>${JSON.stringify(\r\n              response\r\n            )}</code>`,\r\n            form\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          showMessage(`Failed :( <code>${JSON.stringify(error)}</code>`, form);\r\n          console.log(error);\r\n        });\r\n    } else {\r\n      showMessage(`Passwords do not match`, e.target);\r\n      console.log(\"faill\");\r\n    }\r\n  });\r\n//login\r\ndocument.querySelector(\"form[name='login']\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const form = e.target;\r\n  if (!auth) {\r\n    noAuthFound(form);\r\n  }\r\n  const { email, password } = form.elements;\r\n  auth\r\n    .login(email.value, password.value, true)\r\n    .then((response) => {\r\n      showMessage(`<p>Log in successful! </p>`, form);\r\n      console.log(response);\r\n      user = auth.currentUser();\r\n\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n\r\n      window.location.href = \"/dashboard.html\";\r\n    })\r\n    .catch((error) => {\r\n      showMessage(`Failed to log in :`, form);\r\n      console.log(error);\r\n    });\r\n});\r\nfunction updateThing() {\r\n  user = auth.currentUser();\r\n\r\n  user\r\n    .update({\r\n      data: {\r\n        you: \"are awesome\",\r\n      },\r\n    })\r\n    .then((user) => console.log(user));\r\n}\r\n\r\n//request recovery email\r\ndocument\r\n  .querySelector(\"form[name='recover-pass']\")\r\n  .addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n    const form = e.target;\r\n\r\n    if (!auth) {\r\n      noAuthFound(form);\r\n    }\r\n\r\n    if (!auth.currentUser()) {\r\n      noUserFound(form);\r\n    }\r\n\r\n    const user = auth.currentUser();\r\n    const email = user.email;\r\n\r\n    auth\r\n      .requestPasswordRecovery(email)\r\n      .then((response) => {\r\n        showMessage(`<p>Recovery email sent, check your inbox! </p>`, form);\r\n        console.log(response);\r\n      })\r\n      .catch((error) => {\r\n        showMessage(`Something went wrong :(`, form);\r\n        console.log(error);\r\n      });\r\n  });\r\n\r\n//helper functions\r\n\r\nfunction noAuthFound(form) {\r\n  showMessage(`<p>Did you paste in your API endpoint?</p>`, form);\r\n}\r\n\r\nfunction noUserFound(form) {\r\n  showMessage(`<p>User not found</p>`, form);\r\n}\r\n\r\nfunction showMessage(msg, el) {\r\n  el.querySelector(\".message\").innerHTML = msg;\r\n}\r\n\r\nfunction clearPage() {\r\n  document.querySelectorAll(\".message\").forEach((el) => {\r\n    el.textContent = \"\";\r\n  });\r\n}\r\n"],"names":["$92df2eb412a50ae5c8a22c81bad9762b$var$user","$92df2eb412a50ae5c8a22c81bad9762b$var$toggleExisting","console","log","document","querySelector","classList","add","remove","$92df2eb412a50ae5c8a22c81bad9762b$var$toggleCreate","$92df2eb412a50ae5c8a22c81bad9762b$var$toggleResetPass","window","addEventListener","$92df2eb412a50ae5c8a22c81bad9762b$var$auth","$parcel$interopDefault","$17dAM","APIUrl","setCookie","$92df2eb412a50ae5c8a22c81bad9762b$var$noAuthFound","form","$92df2eb412a50ae5c8a22c81bad9762b$var$showMessage","msg","el","innerHTML","e","preventDefault","target","elements","password","value","password2","email","name","signup","data","full_name","then","response","JSON","stringify","catch","error","login","currentUser","localStorage","setItem","location","href","$92df2eb412a50ae5c8a22c81bad9762b$var$noUserFound","requestPasswordRecovery"],"version":3,"file":"login.HASH_REF_4337eff8e2ce008325df7525f5ce6d6f.js.map"}